%spark.r
library(devtools)
library(rPython)
# install('/usr/local/zeppelin/custom-lib/flytxtSparkLib/flytxtRSparkLib')
install.packages('/usr/local/zeppelin/custom-lib/flytxtRSparkLib/flytxtRSparkLib', repos = NULL, type="source")
library(flytxtRSparkLib)
dataFrame=getDataFrameWithName ("D2","System Global","Affinity/SelModel7665",FALSE)
# showDF(dataFrame)
dataFrame= withColumn(dataFrame, "Date", date_format(dataFrame$Date, "ddMMYYYY HH:mm:ss"))
updateCustomerMetric(dataFrame,'CONSUMER_ID','Age_q11','Date','set','Selenium Revenue Metric_q11',TRUE,TRUE,TRUE)
updateCustomerProfile(dataFrame,'CONSUMER_ID','Demographics_q11','set','Age_q11')
dfFields <- list('CONSUMER_ID','Demographics_q11','Date','Age_q11')
names(dfFields) <- c('msisdn','subDomain1','eventDate','eventValue')
updateEvent(dataFrame,1004,'set','System Global',dfFields)